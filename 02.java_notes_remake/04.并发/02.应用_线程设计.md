<!-- TOC -->

- [1. 进程和线程的应用](#1-进程和线程的应用)
  - [1.1. 异步调用](#11-异步调用)
    - [1.1.1. 概念](#111-概念)
    - [1.1.2. 设计](#112-设计)
    - [1.1.3. 总结](#113-总结)
  - [1.2. 利用多核提高效率](#12-利用多核提高效率)
    - [1.2.1. 总结](#121-总结)

<!-- /TOC -->

## 1. 进程和线程的应用

### 1.1. 异步调用

#### 1.1.1. 概念
- 从方法的调用角度来说, 如果
  - 需要等待上一个方法结果返回, 后面的方法才能继续运行就是同步的
  - 不需要等待上一个方法结果返回, 后面的方法也能继续运行的就是异步的

- 注: 同步在多线程中的另一个概念, 是让多个线程步调一致

#### 1.1.2. 设计
- 多线程可以让方法的执行顺序变成异步的, 例如读取磁盘资源的时候, 读取操作通常花费很长时间,  
  如果没有线程调度机制, 在读取资源这段时间内调用者不能做任何操作, 只能等读取完成, 其余代码都要暂停.

- 如下实例代码所示, 将读取操作单独作为一个线程提取出来运行, 其余的的方法操作继续由主线程运行,  
  这样就可以做到, 在读取资源的时候, 其它方法的调用和运行都能正常执行, 避免阻塞主线程.

- 实例  
  ```java
    public static void main(String[] args){
        new Thread(()->FileReader.read(FILE_PATH)).start();
        sout("doing other thing");
    }
  ```

#### 1.1.3. 总结
- 若一些不需要依赖那些耗时较长操作的方法的返回结果也能运行, 那么可以将那些耗时脚长的操作, 单独提取出来作为一个新的线程进行处理.

----

### 1.2. 利用多核提高效率
- 充分利用多核 CPU 的优势, 提高运行效率. 例如有以下的场景, 执行三个计算, 最终汇总结果.
  ```
  计算 1 花费 10ms
  计算 2 花费 11ms
  计算 3 花费 9ms
  汇总需要 1ms
  ```

- 如果是串行执行, 那么总共花费时间是 10+11+9+1 = 31ms.
- 如果是四核 CPU, 各个核心分别使用单独的线程各自并行计算, 花费时间只取决于耗时最长的那个线程, 即 11ms, 最终加上汇总, 一共花费 12ms.
- 注意: 单核 CPU 依旧是轮流执行线程, 只有多核 CPU 才能进行并行处理.

#### 1.2.1. 总结
1. 单核 CPU 下, 多线程不能实际提高运行效率, 只是为了能够在不同的任务间切换, 让不同线程轮流使用 CPU,  
   从而不至于一个线程总占用 CPU, 别的线程没法干活

2. 多核 CPU 可以并行跑多个线程, 但能否提高程序运行效率需要分情况考虑
    - 有些任务, 经过精心设计, 将任务拆分, 并行执行, 当然可以提高程序的运行效率.   
    - 但不是所有计算任务都能拆分, 也不是所有任务都需要拆分, 任务的目的如果不同, 谈拆分和效率没意义

3. IO 操作并不占用 CPU, 只是通常拷贝文件使用的是[阻塞 IO], 这时相当于线程虽然不用 CPU,   
   但要一直等待 IO 结束, 没能充分利用线程. 所以后面才有[非阻塞 IO]和[异步 IO]的优化.
