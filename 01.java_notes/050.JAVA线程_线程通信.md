<!-- TOC -->

- [1. 线程通信](#1-线程通信)
  - [1.1. 案例释义](#11-案例释义)
    - [1.1.1. 分析示图:](#111-分析示图)
    - [1.1.2. 案例描述](#112-案例描述)
    - [1.1.3. 案例实现](#113-案例实现)

<!-- /TOC -->

## 1. 线程通信
- 不同的线程执行不同的任务, 若这些任务有联系, 线程之间必须能够通信才能协调完成工作.  

### 1.1. 案例释义
- 经典的生产者和消费者案例(Producer/Consumer):
![pic](../99.images/2021-01-04-00-23-44.png)

#### 1.1.1. 分析示图:  
1) 生产者和消费者应该操作共享的资源(实现方式来做). 
2) 使用一个或多个线程来表示生产者(Producer).
3) 使用一个或多个线程来表示消费者(Consumer).
4) 这种将生产者/资源/消费者独立开来的设计模式体现了面向对象的思想  
   1) 实现了低耦合, 使得每件事物之间互相独立;
   2) 让生产者和消费者之间通过第三方进行交换数据, 使其互相不需引用.

#### 1.1.2. 案例描述
![pic](../99.images/2021-01-04-00-40-30.png)
- 如上获取一个全新的更为详细的案例描述:
  - 生产者负责存入姓名和性别数据
  - 消费者负责取出数据并进行打印
  - 假设现在只能存一个再取一个

- 对于生产者来说:  
如果共享资源中没有数据, 则生产者负责生产一个数据(姓名-性别), 共享资源为不空了.  
否则生产者等待消费者消费该数据.  

- 对于消费者来说:  
如果共享资源中没有数据, 则消费者应该等待生产者生产数据.   
否则消费者取出该数据. 共享资源为空了.

#### 1.1.3. 案例实现
- 共享资源类的实现
```java
//共享资源对象(姓名-性别) 
public class ShareResource {
    private String name;
    private String gender;

    /**
     * 生产者向共享资源对象中存储数据
     * @param name 存储的姓名
     * @param gender 存储的性别
     */
    public void push(String name, String gender) {
        this.name = name;
        this.gender = gender;
    }

    /**
    * 消费者从共享资源对象中取出数据
    */
    public void popup() {
        System.out.println(this.name + "-" + this.gender);
    }
}
```

- 生产者类的实现
```java
//生产者
public class Producer implements Runnable {
    //共享的资源对象, 设定为 null
    private ShareResource resource = null;

    //通过构造器将共同的共享资源传递进来 
    public Producer(ShareResource resource) {
        this.resource = resource;
    }

    public void run() {
        for (int i = O; i < 50; i++) {
            if (i % 2 == 0) {
                resource.push("春哥哥"，"男");
            } else {
                resource.push("凤姐", "女");
            }
        }
    }
}
```

- 消费者类的实现
```java
//消费者
public class Consumer implements Runnable {
    //共享的资源对象
    private ShareResource resource = null;

    public Consumer(ShareResource resource) {
        this.resource = resource;
    }

    public void run() {
        for (int i = 0; i < 50; i++) {
            resource.popup();
        }
    }
}
```

- 测试类的实现
```java
//测试代码
pablic class App {
    public static void main (String[] args) {
        //创建生产者和消费者共同的资源对象
        ShareResource resource = new ShareResource();
        //启动生产者线程
        new Thread(new Producer(resource)).start();
        //启动消费者线程
        new Thread(new Consumer(resource)).start();
    }
}
```